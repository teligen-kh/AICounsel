# AI Counsel í”„ë¡œì íŠ¸ ì˜ì¡´ì„± ë§µ
# ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2024-12-03

## ğŸ“ í•µì‹¬ íŒŒì¼ ì˜ì¡´ì„± ê´€ê³„

### 1. main.py (ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì )
```
main.py
â”œâ”€â”€ fastapi (ì›¹ í”„ë ˆì„ì›Œí¬)
â”œâ”€â”€ fastapi.middleware.cors (CORS ë¯¸ë“¤ì›¨ì–´)
â”œâ”€â”€ motor.motor_asyncio (MongoDB ë¹„ë™ê¸° ë“œë¼ì´ë²„)
â”œâ”€â”€ uvicorn (ASGI ì„œë²„)
â”œâ”€â”€ app.dependencies (ì˜ì¡´ì„± ì£¼ì…)
â”œâ”€â”€ app.services.chat_service (ì±„íŒ… ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.llm_service (LLM ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.routers.chat (ì±„íŒ… ë¼ìš°í„°)
â””â”€â”€ app.services.model_manager (ëª¨ë¸ ê´€ë¦¬ì)
```

### 2. app/dependencies.py (ì˜ì¡´ì„± ì£¼ì… ê´€ë¦¬)
```
dependencies.py
â”œâ”€â”€ app.database (ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°)
â”œâ”€â”€ app.services.llm_service (LLM ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.chat_service (ì±„íŒ… ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.mongodb_search_service (ê²€ìƒ‰ ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.conversation_algorithm (ëŒ€í™” ì•Œê³ ë¦¬ì¦˜)
â”œâ”€â”€ app.services.formatting_service (í¬ë§·íŒ… ì„œë¹„ìŠ¤)
â””â”€â”€ app.services.model_manager (ëª¨ë¸ ê´€ë¦¬ì)
```

### 3. app/services/chat_service.py (ì±„íŒ… ì„œë¹„ìŠ¤)
```
chat_service.py
â”œâ”€â”€ app.services.llm_service (LLM ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.mongodb_search_service (ê²€ìƒ‰ ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.conversation_algorithm (ëŒ€í™” ì•Œê³ ë¦¬ì¦˜)
â”œâ”€â”€ app.services.formatting_service (í¬ë§·íŒ… ì„œë¹„ìŠ¤)
â””â”€â”€ app.services.model_manager (ëª¨ë¸ ê´€ë¦¬ì)
```

### 4. app/services/llm_service.py (LLM ì„œë¹„ìŠ¤)
```
llm_service.py
â”œâ”€â”€ app.services.llm_processors (ëª¨ë¸ë³„ í”„ë¡œì„¸ì„œ)
â”œâ”€â”€ app.services.mongodb_search_service (ê²€ìƒ‰ ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.conversation_algorithm (ëŒ€í™” ì•Œê³ ë¦¬ì¦˜)
â”œâ”€â”€ app.services.formatting_service (í¬ë§·íŒ… ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.model_manager (ëª¨ë¸ ê´€ë¦¬ì)
â””â”€â”€ transformers (Hugging Face ë¼ì´ë¸ŒëŸ¬ë¦¬)
```

### 5. app/services/llm_processors.py (ëª¨ë¸ë³„ í”„ë¡œì„¸ì„œ)
```
llm_processors.py
â”œâ”€â”€ abc (ì¶”ìƒ í´ë˜ìŠ¤)
â”œâ”€â”€ typing (íƒ€ì… íŒíŠ¸)
â””â”€â”€ logging (ë¡œê¹…)
```

### 6. app/routers/chat.py (ì±„íŒ… API ë¼ìš°í„°)
```
chat.py
â”œâ”€â”€ fastapi (ì›¹ í”„ë ˆì„ì›Œí¬)
â”œâ”€â”€ app.dependencies (ì˜ì¡´ì„± ì£¼ì…)
â”œâ”€â”€ app.services.chat_service (ì±„íŒ… ì„œë¹„ìŠ¤)
â”œâ”€â”€ app.services.llm_service (LLM ì„œë¹„ìŠ¤)
â””â”€â”€ pydantic (ë°ì´í„° ê²€ì¦)
```

## ğŸ”„ ìˆœí™˜ ì˜ì¡´ì„± ìœ„í—˜ êµ¬ê°„

### âš ï¸ ì£¼ì˜: ìˆœí™˜ ì˜ì¡´ì„± ê°€ëŠ¥ì„±
```
dependencies.py â†” chat_service.py â†” llm_service.py
```

### ğŸ”§ í•´ê²° ë°©ë²•
- ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•œ ëŠìŠ¨í•œ ê²°í•©
- ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì„¤ê³„
- ì„œë¹„ìŠ¤ íŒ©í† ë¦¬ íŒ¨í„´ ì‚¬ìš©

## ğŸ“Š API ì—”ë“œí¬ì¸íŠ¸ ì˜ì¡´ì„±

### POST /api/v1/chat/send
```
chat.py â†’ dependencies.py â†’ chat_service.py â†’ llm_service.py
```

### POST /api/v1/chat/switch-model
```
chat.py â†’ dependencies.py â†’ chat_service.py â†’ llm_service.py â†’ model_manager.py
```

### GET /api/v1/chat/model-status
```
chat.py â†’ dependencies.py â†’ chat_service.py â†’ llm_service.py â†’ model_manager.py
```

## ğŸ› ï¸ ìˆ˜ì • ì‹œ ì˜í–¥ë„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. ëª¨ë¸ ê´€ë ¨ ìˆ˜ì • ì‹œ
- [ ] app/services/model_manager.py
- [ ] app/services/llm_service.py
- [ ] app/services/llm_processors.py
- [ ] app/dependencies.py
- [ ] app/main.py (ê¸°ë³¸ ëª¨ë¸ ì„¤ì •)

### 2. API ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ì • ì‹œ
- [ ] app/routers/chat.py
- [ ] app/services/chat_service.py
- [ ] frontend/src/services/api.ts
- [ ] frontend/src/app/chat/page.tsx

### 3. ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ìˆ˜ì • ì‹œ
- [ ] app/database.py
- [ ] app/services/mongodb_search_service.py
- [ ] app/dependencies.py

### 4. ì„œë¹„ìŠ¤ ë¡œì§ ìˆ˜ì • ì‹œ
- [ ] app/services/chat_service.py
- [ ] app/services/llm_service.py
- [ ] app/services/conversation_algorithm.py
- [ ] app/dependencies.py

## ğŸ” ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œì 

### 1. Import ê²½ë¡œ ë¬¸ì œ
```
âŒ from .model_manager import ...
âœ… from .services.model_manager import ...
```

### 2. ìˆœí™˜ Import ë¬¸ì œ
```
âŒ chat_service.py â†” llm_service.py ì§ì ‘ import
âœ… dependencies.pyë¥¼ í†µí•œ ì˜ì¡´ì„± ì£¼ì…
```

### 3. API ê²½ë¡œ ë¶ˆì¼ì¹˜
```
âŒ í”„ë¡ íŠ¸ì—”ë“œ: /api/v1/chat
âœ… ë°±ì—”ë“œ: /api/v1/chat/send
```

### 4. ë¹„ë™ê¸° ì˜ì¡´ì„± ì£¼ì… ë¬¸ì œ
```
âŒ def get_database() â†’ await ì—†ì´ í˜¸ì¶œ
âœ… async def get_database() â†’ awaitë¡œ í˜¸ì¶œ
âŒ get_chat_service_dependency() â†’ await ì—†ì´ í˜¸ì¶œ
âœ… await get_chat_service_dependency() â†’ awaitë¡œ í˜¸ì¶œ
```

## ğŸ“ ìˆ˜ì • ì‹œ ì²´í¬ í¬ì¸íŠ¸

### ì½”ë“œ ìˆ˜ì • ì „
1. [ ] ì´ íŒŒì¼ì´ ì–´ë–¤ ë‹¤ë¥¸ íŒŒì¼ë“¤ì„ importí•˜ëŠ”ê°€?
2. [ ] ì´ íŒŒì¼ì´ ì–´ë–¤ ë‹¤ë¥¸ íŒŒì¼ë“¤ì— ì˜í•´ importë˜ëŠ”ê°€?
3. [ ] ìˆœí™˜ ì˜ì¡´ì„±ì´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆëŠ”ê°€?
4. [ ] API ì—”ë“œí¬ì¸íŠ¸ê°€ ë³€ê²½ë˜ëŠ”ê°€?

### ì½”ë“œ ìˆ˜ì • í›„
1. [ ] Import ê²½ë¡œê°€ ì˜¬ë°”ë¥¸ê°€?
2. [ ] ì˜ì¡´ì„± ì£¼ì…ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ê°€?
3. [ ] API ì‘ë‹µ í˜•ì‹ì´ ì¼ì¹˜í•˜ëŠ”ê°€?
4. [ ] í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ë™ê¸°í™”ë˜ì—ˆëŠ”ê°€?

## ğŸš€ ìë™í™” ë„êµ¬

### Python ì˜ì¡´ì„± ë¶„ì„
```bash
# ì˜ì¡´ì„± ë§µ ìƒì„±
pydeps app/main.py --show-deps

# ìˆœí™˜ ì˜ì¡´ì„± ê²€ì‚¬
pip install import-linter
lint-imports
```

### TypeScript ì˜ì¡´ì„± ë¶„ì„
```bash
# ì˜ì¡´ì„± ê·¸ë˜í”„ ìƒì„±
npm install -g madge
madge --image dependency-graph.svg src/
```

## ğŸ“‹ í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœ

### âœ… ì™„ë£Œëœ ë¦¬íŒ©í† ë§
- [x] ëª¨ë¸ë³„ í”„ë¡œì„¸ì„œ ë¶„ë¦¬
- [x] ì—…ë¬´ë³„ ë©”ì„œë“œ ë¶„ë¦¬
- [x] ì˜ì¡´ì„± ì£¼ì… êµ¬í˜„
- [x] API ì—”ë“œí¬ì¸íŠ¸ ì •ë¦¬

### ğŸ”„ ì§„í–‰ ì¤‘ì¸ ì‘ì—…
- [x] ì˜ì¡´ì„± ë§µ ìë™ ì—…ë°ì´íŠ¸
- [x] ìˆœí™˜ ì˜ì¡´ì„± ê²€ì‚¬ ìë™í™”
- [x] API ê²½ë¡œ ì¼ê´€ì„± ê²€ì‚¬
- [x] ë¹„ë™ê¸° ì˜ì¡´ì„± ì£¼ì… ìˆ˜ì •

### ğŸ“ˆ í–¥í›„ ê°œì„ ì‚¬í•­
- [ ] ì˜ì¡´ì„± ë¶„ì„ CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- [ ] ìë™ ë¬¸ì„œí™” ë„êµ¬ ì—°ë™
- [ ] ì½”ë“œ í’ˆì§ˆ ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ

---
**ì°¸ê³ **: ì´ íŒŒì¼ì€ í”„ë¡œì íŠ¸ êµ¬ì¡°ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì—…ë°ì´íŠ¸ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. 