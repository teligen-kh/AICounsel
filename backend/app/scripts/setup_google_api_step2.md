# 구글 API 설정 - 2단계: 스프레드시트 공유 설정

## 🔗 1단계: 스프레드시트 열기

### 1.1 스프레드시트 접속
1. 브라우저에서 다음 링크로 이동:
   ```
   https://docs.google.com/spreadsheets/d/1V1Md1CoauKRIf3HZzUsqNc9nsYX0xvtjqkwMgzPr4tk/edit?gid=1123689008#gid=1123689008
   ```

### 1.2 스프레드시트 확인
- 데이터가 올바르게 표시되는지 확인
- 컬럼명 확인 (요청내용, 처리내용 표준화 등)

## 👥 2단계: 서비스 계정과 공유

### 2.1 공유 버튼 클릭
1. 스프레드시트 우측 상단의 **"공유"** 버튼 클릭
2. 공유 설정 창이 열림

### 2.2 서비스 계정 이메일 추가
1. **"사용자 및 그룹 추가"** 입력창에 서비스 계정 이메일 입력
   - 1단계에서 확인한 `client_email` 값 사용
   - 예: `aicounsel-sheets-service@aicounsel-sheets.iam.gserviceaccount.com`

### 2.3 권한 설정
1. 권한을 **"편집자"**로 설정
2. **"보내기"** 버튼 클릭

### 2.4 공유 확인
- 서비스 계정이 공유 목록에 추가되었는지 확인
- 권한이 "편집자"로 설정되었는지 확인

## 📦 3단계: 필요한 패키지 설치

### 3.1 패키지 설치
```bash
cd D:\AICounsel\backend
pip install gspread google-auth
```

### 3.2 설치 확인
```bash
python -c "import gspread; import google.auth; print('패키지 설치 완료!')"
```

## 🧪 4단계: 테스트 실행

### 4.1 스크립트 실행
```bash
cd D:\AICounsel\backend
python -m app.scripts.import_google_sheets_to_knowledge
```

### 4.2 예상 결과
```
✅ 구글 스프레드시트 로드 완료: XXX행
✅ 데이터 가져오기 시작...
✅ XXX개 문서가 성공적으로 추가되었습니다.
```

## ❌ 5단계: 문제 해결

### 5.1 권한 오류 발생 시
```
❌ 구글 인증 파일을 찾을 수 없습니다: google_credentials.json
```
**해결 방법:**
- JSON 파일이 올바른 위치에 있는지 확인
- 파일명이 정확한지 확인

### 5.2 스프레드시트 접근 오류 시
```
❌ 구글 스프레드시트 연결 오류: 403 Forbidden
```
**해결 방법:**
- 서비스 계정 이메일이 스프레드시트에 공유되었는지 확인
- 권한이 "편집자" 이상인지 확인

### 5.3 API 할당량 초과 시
```
❌ API 할당량 초과
```
**해결 방법:**
- Google Cloud Console에서 할당량 확인
- 필요시 할당량 증가 요청

## 🎯 완료 조건
- ✅ 스프레드시트가 서비스 계정과 공유됨
- ✅ 서비스 계정 권한이 "편집자"로 설정됨
- ✅ 필요한 패키지 설치 완료
- ✅ 스크립트 실행 성공
- ✅ 데이터가 knowledge_base에 추가됨

## 🚀 다음 단계
설정이 완료되면:
1. **실시간 동기화**: 스프레드시트 수정 시 자동 반영
2. **자동 중복 제거**: 새 데이터만 추가
3. **편리한 관리**: 스프레드시트에서 직접 데이터 편집

모든 설정이 완료되었습니다! 🎉 